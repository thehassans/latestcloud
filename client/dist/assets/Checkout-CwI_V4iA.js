import{d as e,a as s,f as a,j as r,H as l,z as t,o as i}from"./index-om1Vn67a.js";import{u as n,r as d}from"./vendor-DCxmN9Fm.js";import{am as c,an as o,ao as m,X as x,ap as u,$ as p}from"./ui-ClKTfOIO.js";import"./charts-CbuEd0CO.js";const h=[{id:"card",name:"Credit/Debit Card",icon:c,requiresProof:!1},{id:"paypal",name:"PayPal",icon:c,requiresProof:!1},{id:"bank",name:"Bank Transfer",icon:o,requiresProof:!0},{id:"cash",name:"Cash Payment",icon:m,requiresProof:!0}];function j(){const c=n(),{items:o,coupon:m,getTotal:j,clearCart:b}=e(),{format:f}=s(),{user:N}=a(),{subtotal:y,discount:g,total:v}=j(),[k,P]=d.useState(!1),[w,C]=d.useState("card"),[_,q]=d.useState(null),[S,B]=d.useState(null),F=h.find(e=>e.id===w);return 0===o.length?(c("/cart"),null):r.jsxs(r.Fragment,{children:[r.jsx(l,{children:r.jsx("title",{children:"Checkout - Magnetic Clouds"})}),r.jsx("section",{className:"section",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[r.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Checkout"}),r.jsxs("div",{className:"grid lg:grid-cols-5 gap-8",children:[r.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[r.jsxs("div",{className:"card p-6",children:[r.jsx("h2",{className:"text-lg font-bold mb-4",children:"Billing Information"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"First Name"}),r.jsx("input",{type:"text",defaultValue:null==N?void 0:N.first_name,className:"input"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Last Name"}),r.jsx("input",{type:"text",defaultValue:null==N?void 0:N.last_name,className:"input"})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email"}),r.jsx("input",{type:"email",defaultValue:null==N?void 0:N.email,className:"input"})]})]})]}),r.jsxs("div",{className:"card p-6",children:[r.jsx("h2",{className:"text-lg font-bold mb-4",children:"Payment Method"}),r.jsx("div",{className:"space-y-3",children:h.map(e=>r.jsxs("label",{className:"flex items-center gap-3 p-4 border rounded-xl cursor-pointer transition-colors\n                      "+(w===e.id?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-dark-200 dark:border-dark-700"),children:[r.jsx("input",{type:"radio",name:"payment",value:e.id,checked:w===e.id,onChange:()=>C(e.id),className:"text-primary-500"}),r.jsx(e.icon,{className:"w-5 h-5"}),r.jsx("span",{children:e.name}),e.requiresProof&&r.jsx("span",{className:"ml-auto text-xs text-dark-500",children:"(Proof required)"})]},e.id))}),(null==F?void 0:F.requiresProof)&&r.jsxs("div",{className:"mt-6 p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:[r.jsx("h3",{className:"font-medium text-amber-800 dark:text-amber-200 mb-2",children:"Payment Instructions"}),"bank"===w&&r.jsxs("div",{className:"text-sm text-amber-700 dark:text-amber-300 mb-4",children:[r.jsx("p",{className:"mb-2",children:"Transfer to:"}),r.jsxs("p",{children:[r.jsx("strong",{children:"Bank:"})," Example Bank"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Account:"})," 1234567890"]}),r.jsxs("p",{children:[r.jsx("strong",{children:"Name:"})," Magnetic Clouds Ltd"]})]}),"cash"===w&&r.jsx("div",{className:"text-sm text-amber-700 dark:text-amber-300 mb-4",children:r.jsx("p",{children:"Contact us to arrange cash payment. Upload receipt after payment."})}),r.jsxs("label",{className:"block",children:[r.jsx("span",{className:"text-sm font-medium mb-2 block",children:"Upload Payment Proof *"}),S?r.jsxs("div",{className:"relative inline-block",children:[r.jsx("img",{src:S,alt:"Payment proof",className:"max-w-xs max-h-48 rounded-lg border"}),r.jsx("button",{onClick:()=>{q(null),B(null)},className:"absolute -top-2 -right-2 p-1 bg-red-500 text-white rounded-full",children:r.jsx(x,{className:"w-4 h-4"})})]}):r.jsxs("div",{className:"border-2 border-dashed border-dark-300 dark:border-dark-600 rounded-xl p-6 text-center cursor-pointer hover:border-primary-500 transition-colors",children:[r.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var s;const a=null==(s=e.target.files)?void 0:s[0];if(a){if(a.size>5242880)return void t.error("File size must be less than 5MB");const e=new FileReader;e.onloadend=()=>{q(e.result),B(e.result)},e.readAsDataURL(a)}},className:"hidden",id:"proof-upload"}),r.jsxs("label",{htmlFor:"proof-upload",className:"cursor-pointer",children:[r.jsx(u,{className:"w-8 h-8 mx-auto mb-2 text-dark-400"}),r.jsx("p",{className:"text-sm text-dark-500",children:"Click to upload receipt/screenshot"}),r.jsx("p",{className:"text-xs text-dark-400",children:"Max 5MB, JPG/PNG"})]})]})]})]})]})]}),r.jsx("div",{className:"lg:col-span-2",children:r.jsxs("div",{className:"card p-6 sticky top-24",children:[r.jsx("h2",{className:"text-lg font-bold mb-4",children:"Order Summary"}),r.jsxs("div",{className:"space-y-3 mb-6",children:[o.map(e=>r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-dark-500",children:e.name}),r.jsx("span",{children:f(e.price)})]},e.id)),r.jsxs("div",{className:"border-t pt-3",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-dark-500",children:"Subtotal"}),r.jsx("span",{children:f(y)})]}),g>0&&r.jsxs("div",{className:"flex justify-between text-sm text-green-500",children:[r.jsx("span",{children:"Discount"}),r.jsxs("span",{children:["-",f(g)]})]})]}),r.jsxs("div",{className:"border-t pt-3 flex justify-between font-bold text-lg",children:[r.jsx("span",{children:"Total"}),r.jsx("span",{children:f(v)})]})]}),r.jsx("button",{onClick:async()=>{var e,s;if(!(null==F?void 0:F.requiresProof)||_){P(!0);try{const e=o.map(e=>({type:e.type,product_uuid:e.product_uuid,domain_name:e.domain_name,tld:e.tld,action:e.action,billing_cycle:e.billingCycle,product_type:e.product_type,years:e.years,quantity:e.quantity||1}));await i.create({items:e,coupon_code:null==m?void 0:m.code,payment_method:w,payment_proof:_,billing_address:{name:`${N.first_name} ${N.last_name}`,email:N.email}}),b(),t.success("Order placed successfully! "+((null==F?void 0:F.requiresProof)?"We will verify your payment shortly.":"")),c("/dashboard/orders")}catch(a){t.error((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.error)||"Checkout failed")}finally{P(!1)}}else t.error("Please upload payment proof")},disabled:k,className:"btn-primary w-full justify-center",children:k?"Processing...":r.jsxs(r.Fragment,{children:[r.jsx(p,{className:"w-4 h-4 mr-2"})," Pay ",f(v)]})}),r.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 text-xs text-dark-500",children:[r.jsx(p,{className:"w-3 h-3"}),"Secured by 256-bit SSL encryption"]})]})})]})]})})]})}export{j as default};
