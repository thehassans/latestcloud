import{b as e,c as a,j as s,H as t,G as l,z as i}from"./index-BfBk6Bdx.js";import{r as c}from"./vendor-DCxmN9Fm.js";import{o as r,ar as n,X as o,G as d,as as m,al as x,ao as h}from"./ui-BenWBvXj.js";import"./charts-CbuEd0CO.js";function g(){const{themeStyle:g,setThemeStyle:u}=e(),{siteName:p,siteTagline:j,logo:b,favicon:f,contactEmail:v,setSiteSettings:N,updateSiteSetting:k}=a(),[y,w]=c.useState(!1),[S,C]=c.useState({siteName:p||"Magnetic Clouds",siteTagline:j||"Premium Cloud Hosting",contactEmail:v||"support@magneticclouds.com",logo:b||null,favicon:f||null}),E=c.useRef(null),T=c.useRef(null);c.useEffect(()=>{(async()=>{try{const e=await l.get("/settings/public");if(e.data.settings){const a=e.data.settings;C(e=>({...e,siteName:a.site_name||e.siteName,siteTagline:a.site_tagline||e.siteTagline,contactEmail:a.contact_email||e.contactEmail,logo:a.site_logo||e.logo,favicon:a.site_favicon||e.favicon}))}}catch(e){console.error("Failed to load settings:",e)}})()},[]);const F=async(e,a)=>{if(e)try{const s=new FileReader;s.onloadend=()=>{const e=s.result,t=new window.Image;t.onload=()=>{try{let e=t.width,s=t.height;const l="favicon"===a?32:100,c="favicon"===a?32:300;"favicon"===a?(e=32,s=32):(s>l&&(e=e*l/s,s=l),e>c&&(s=s*c/e,e=c));const r=document.createElement("canvas");r.width=e,r.height=s;r.getContext("2d").drawImage(t,0,0,e,s);const n=r.toDataURL("image/png");C(e=>({...e,[a]:n})),i.success(("logo"===a?"Logo":"Favicon")+" uploaded successfully!")}catch(s){console.error("Canvas error:",s),C(s=>({...s,[a]:e})),i.success(("logo"===a?"Logo":"Favicon")+" uploaded!")}},t.onerror=()=>{C(s=>({...s,[a]:e})),i.success(("logo"===a?"Logo":"Favicon")+" uploaded!")},t.src=e},s.onerror=()=>{i.error("Failed to read file")},s.readAsDataURL(e)}catch(s){console.error("Upload error:",s),i.error("Failed to upload file")}};return s.jsxs(s.Fragment,{children:[s.jsx(t,{children:s.jsxs("title",{children:["Settings - Admin - ",S.siteName]})}),s.jsx("h1",{className:"text-2xl font-bold mb-8",children:"Site Settings"}),s.jsxs("div",{className:"space-y-8 max-w-3xl",children:[s.jsxs("div",{className:"card p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx(r,{className:"w-6 h-6 text-primary-500"}),s.jsx("h2",{className:"text-lg font-bold",children:"Branding"})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Site Logo"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-32 h-32 border-2 border-dashed border-dark-300 dark:border-dark-600 rounded-xl flex items-center justify-center overflow-hidden bg-dark-50 dark:bg-dark-800",children:S.logo&&S.logo.startsWith("data:image")?s.jsx("img",{src:S.logo,alt:"",className:"w-full h-full object-contain p-2"}):s.jsx(n,{className:"w-8 h-8 text-dark-400"})}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("input",{ref:E,type:"file",accept:"image/*",className:"hidden",onChange:e=>F(e.target.files[0],"logo")}),s.jsxs("button",{onClick:()=>{var e;return null==(e=E.current)?void 0:e.click()},className:"btn-outline text-sm",children:[s.jsx(n,{className:"w-4 h-4 mr-2"})," Upload Logo"]}),S.logo&&S.logo.startsWith("data:image")&&s.jsxs("button",{onClick:()=>C(e=>({...e,logo:null})),className:"btn text-sm text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",children:[s.jsx(o,{className:"w-4 h-4 mr-2"})," Remove"]}),s.jsx("p",{className:"text-xs text-dark-500",children:"Recommended: 200x60px, PNG/SVG"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Favicon"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-16 h-16 border-2 border-dashed border-dark-300 dark:border-dark-600 rounded-xl flex items-center justify-center overflow-hidden bg-dark-50 dark:bg-dark-800",children:S.favicon&&S.favicon.startsWith("data:image")?s.jsx("img",{src:S.favicon,alt:"",className:"w-full h-full object-contain p-1"}):s.jsx(n,{className:"w-5 h-5 text-dark-400"})}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("input",{ref:T,type:"file",accept:"image/*,.ico",className:"hidden",onChange:e=>F(e.target.files[0],"favicon")}),s.jsxs("button",{onClick:()=>{var e;return null==(e=T.current)?void 0:e.click()},className:"btn-outline text-sm",children:[s.jsx(n,{className:"w-4 h-4 mr-2"})," Upload Favicon"]}),S.favicon&&S.favicon.startsWith("data:image")&&s.jsxs("button",{onClick:()=>C(e=>({...e,favicon:null})),className:"btn text-sm text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",children:[s.jsx(o,{className:"w-4 h-4 mr-2"})," Remove"]}),s.jsx("p",{className:"text-xs text-dark-500",children:"Recommended: 32x32px, ICO/PNG"})]})]})]})]})]}),s.jsxs("div",{className:"card p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx(d,{className:"w-6 h-6 text-primary-500"}),s.jsx("h2",{className:"text-lg font-bold",children:"General"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Site Name"}),s.jsx("input",{type:"text",value:S.siteName,onChange:e=>C(a=>({...a,siteName:e.target.value})),className:"input",placeholder:"Your Site Name"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Site Tagline"}),s.jsx("input",{type:"text",value:S.siteTagline,onChange:e=>C(a=>({...a,siteTagline:e.target.value})),className:"input",placeholder:"Your site tagline"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Contact Email"}),s.jsx("input",{type:"email",value:S.contactEmail,onChange:e=>C(a=>({...a,contactEmail:e.target.value})),className:"input",placeholder:"support@example.com"})]})]})]}),s.jsxs("div",{className:"card p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx(m,{className:"w-6 h-6 text-primary-500"}),s.jsx("h2",{className:"text-lg font-bold",children:"Appearance"})]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Theme Style"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:()=>u("gradient"),className:"p-4 rounded-xl border-2 transition-all "+("gradient"===g?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-dark-200 dark:border-dark-700"),children:[s.jsx("div",{className:"h-8 rounded bg-gradient-to-r from-primary-500 to-secondary-500 mb-2"}),s.jsx("p",{className:"font-medium",children:"Gradient"})]}),s.jsxs("button",{onClick:()=>u("flat"),className:"p-4 rounded-xl border-2 transition-all "+("flat"===g?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-dark-200 dark:border-dark-700"),children:[s.jsx("div",{className:"h-8 rounded bg-primary-500 mb-2"}),s.jsx("p",{className:"font-medium",children:"Flat"})]})]})]})})]}),s.jsxs("div",{className:"card p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx(x,{className:"w-6 h-6 text-primary-500"}),s.jsx("h2",{className:"text-lg font-bold",children:"Billing"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Default Currency"}),s.jsxs("select",{className:"input",children:[s.jsx("option",{children:"USD"}),s.jsx("option",{children:"EUR"}),s.jsx("option",{children:"GBP"}),s.jsx("option",{children:"BDT"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Money Back Days"}),s.jsx("input",{type:"number",defaultValue:"45",className:"input"})]})]})]}),s.jsxs("button",{onClick:async()=>{w(!0);try{if(await l.put("/settings",{settings:{site_name:S.siteName,site_tagline:S.siteTagline,contact_email:S.contactEmail,site_logo:S.logo,site_favicon:S.favicon}}),N({siteName:S.siteName,siteTagline:S.siteTagline,contactEmail:S.contactEmail,logo:S.logo,favicon:S.favicon}),S.favicon){const e=document.querySelector("link[rel*='icon']")||document.createElement("link");e.type="image/x-icon",e.rel="shortcut icon",e.href=S.favicon,document.head.appendChild(e)}document.title=S.siteName,i.success("Settings saved successfully!")}catch(e){console.error("Save error:",e),i.error("Failed to save settings")}w(!1)},disabled:y,className:"btn-primary",children:[s.jsx(h,{className:"w-4 h-4 mr-2"})," ",y?"Saving...":"Save All Settings"]})]})]})}export{g as default};
