import{G as e,j as s,H as a,I as t,z as l}from"./index-DmPFauXL.js";import{r as n}from"./vendor-DCxmN9Fm.js";import{c as i}from"./charts-CbuEd0CO.js";import{p as r,as as d,q as c,Z as m,u as x,X as o,at as g,ag as h,a0 as p,au as j,am as u,J as N,an as b,r as f,aj as y,m as v}from"./ui-BaE8ErLu.js";function k(){const{isEnabled:k,toggleEnabled:w,apiKey:C,setApiKey:A,trainAgent:T,settings:S,updateChatSettings:P,trainingLogs:I,setTrainingLogs:F,savedChats:D,currentAgent:K,agentProfiles:L,isApiValid:E,setIsApiValid:G}=e(),[q,V]=n.useState(!1),[W,M]=n.useState(""),[U,J]=n.useState(!1),[O,R]=n.useState(!1),[z,H]=n.useState(null),[Q,Z]=n.useState(S),[$,_]=n.useState(!0);n.useEffect(()=>{(async()=>{try{const e=await t.get("/ai-agent/settings/admin");e.data&&(M(e.data.apiKey||""),e.data.apiKey&&(A(e.data.apiKey),G(!0)),e.data.settings&&Z(e.data.settings))}catch(e){console.error("Failed to fetch AI agent settings:",e)}_(!1)})()},[]);return s.jsxs(s.Fragment,{children:[s.jsx(a,{children:s.jsx("title",{children:"AI Agent - Admin - Magnetic Clouds"})}),s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-3",children:[s.jsx(r,{className:"w-8 h-8 text-indigo-500"}),"AI Customer Support Agent"]}),s.jsx("p",{className:"text-dark-500 mt-1",children:"Configure and manage your AI-powered chatbot"})]}),s.jsxs("button",{onClick:()=>w(!k),className:i("flex items-center gap-2 px-6 py-3 rounded-xl font-medium transition-all",k?"bg-green-500 text-white hover:bg-green-600":"bg-dark-200 dark:bg-dark-700 text-dark-600 dark:text-dark-400 hover:bg-dark-300 dark:hover:bg-dark-600"),children:[s.jsx(d,{className:"w-5 h-5"}),k?"Enabled":"Disabled"]})]}),s.jsxs("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-dark-500 text-sm",children:"Total Chats"}),s.jsx("p",{className:"text-3xl font-bold mt-1",children:D.length})]}),s.jsx("div",{className:"w-12 h-12 bg-indigo-100 dark:bg-indigo-900/30 rounded-xl flex items-center justify-center",children:s.jsx(c,{className:"w-6 h-6 text-indigo-500"})})]})}),s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-dark-500 text-sm",children:"Status"}),s.jsx("p",{className:"text-xl font-bold mt-1 flex items-center gap-2",children:k?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"})," Active"]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"w-2 h-2 bg-dark-400 rounded-full"})," Inactive"]})})]}),s.jsx("div",{className:i("w-12 h-12 rounded-xl flex items-center justify-center",k?"bg-green-100 dark:bg-green-900/30":"bg-dark-100 dark:bg-dark-700"),children:s.jsx(m,{className:i("w-6 h-6",k?"text-green-500":"text-dark-400")})})]})}),s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-dark-500 text-sm",children:"API Status"}),s.jsx("p",{className:"text-xl font-bold mt-1 flex items-center gap-2",children:E?s.jsxs(s.Fragment,{children:[s.jsx(x,{className:"w-4 h-4 text-green-500"})," Connected"]}):s.jsxs(s.Fragment,{children:[s.jsx(o,{className:"w-4 h-4 text-red-500"})," Not Connected"]})})]}),s.jsx("div",{className:i("w-12 h-12 rounded-xl flex items-center justify-center",E?"bg-green-100 dark:bg-green-900/30":"bg-red-100 dark:bg-red-900/30"),children:s.jsx(g,{className:i("w-6 h-6",E?"text-green-500":"text-red-500")})})]})}),s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-dark-500 text-sm",children:"Available Agents"}),s.jsx("p",{className:"text-3xl font-bold mt-1",children:L.length})]}),s.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-xl flex items-center justify-center",children:s.jsx(r,{className:"w-6 h-6 text-purple-500"})})]})})]}),s.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[s.jsxs("div",{className:"card p-6",children:[s.jsxs("h2",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:[s.jsx(g,{className:"w-5 h-5 text-indigo-500"}),"API Configuration"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Google Gemini API Key"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:q?"text":"password",value:W,onChange:e=>M(e.target.value),placeholder:"Enter your Gemini API key",className:"input pr-12 w-full"}),s.jsx("button",{onClick:()=>V(!q),className:"absolute right-3 top-1/2 -translate-y-1/2 text-dark-400 hover:text-dark-600",children:q?s.jsx(h,{className:"w-5 h-5"}):s.jsx(p,{className:"w-5 h-5"})})]})]}),s.jsxs("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-indigo-500 hover:text-indigo-600",children:[s.jsx(j,{className:"w-4 h-4"}),"Get API key from Google AI Studio"]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:async()=>{if(W.trim()){R(!0),H(null);try{const e=await fetch("/api/ai-agent/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:W})}),s=await e.json();H(s),s.success?l.success(`Connected! Model: ${s.model}`):l.error(s.message||"Connection failed")}catch(e){H({success:!1,message:e.message}),l.error("Failed to test connection")}R(!1)}else l.error("Please enter an API key")},disabled:O,className:"btn-outline flex items-center gap-2",children:[O?s.jsx(u,{className:"w-4 h-4 animate-spin"}):s.jsx(m,{className:"w-4 h-4"}),"Test Connection"]}),s.jsxs("button",{onClick:async()=>{if(!W.trim())return void l.error("Please enter an API key");J(!0);const e=await T(W);J(!1),e.success?l.success(e.message||"API key validated and saved!"):l.error(e.message||"Validation failed")},disabled:U,className:"btn-primary flex items-center gap-2",children:[U?s.jsx(u,{className:"w-4 h-4 animate-spin"}):s.jsx(x,{className:"w-4 h-4"}),"Validate & Save"]})]}),z&&s.jsxs("div",{className:"mt-4 p-4 rounded-lg text-sm "+(z.success?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400"),children:[s.jsx("p",{className:"font-medium mb-1",children:z.success?"Connection Successful!":"Connection Failed"}),z.model&&s.jsxs("p",{children:["Model: ",z.model]}),z.message&&s.jsx("p",{children:z.message}),z.response&&s.jsxs("p",{className:"text-xs mt-2 opacity-75",children:["Response: ",z.response]})]})]})]}),s.jsxs("div",{className:"card p-6",children:[s.jsxs("h2",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:[s.jsx(N,{className:"w-5 h-5 text-indigo-500"}),"Chat Timing Settings"]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Queue Wait Time"}),s.jsxs("span",{className:"text-sm text-dark-500",children:[Q.queueAssignTime/1e3,"s"]})]}),s.jsx("input",{type:"range",min:"5000",max:"30000",step:"1000",value:Q.queueAssignTime,onChange:e=>Z(s=>({...s,queueAssignTime:Number(e.target.value)})),className:"w-full accent-indigo-500"}),s.jsx("p",{className:"text-xs text-dark-400 mt-1",children:"Time before assigning an agent"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Typing Delay"}),s.jsxs("span",{className:"text-sm text-dark-500",children:[Q.typingStartDelay/1e3,"s"]})]}),s.jsx("input",{type:"range",min:"3000",max:"15000",step:"1000",value:Q.typingStartDelay,onChange:e=>Z(s=>({...s,typingStartDelay:Number(e.target.value)})),className:"w-full accent-indigo-500"}),s.jsx("p",{className:"text-xs text-dark-400 mt-1",children:"Delay before typing indicator appears"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Reply Speed"}),s.jsxs("span",{className:"text-sm text-dark-500",children:[Q.replyTimePerWord/1e3,"s/word"]})]}),s.jsx("input",{type:"range",min:"1000",max:"5000",step:"500",value:Q.replyTimePerWord,onChange:e=>Z(s=>({...s,replyTimePerWord:Number(e.target.value)})),className:"w-full accent-indigo-500"}),s.jsx("p",{className:"text-xs text-dark-400 mt-1",children:"Typing duration per word"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Follow-up Timeout"}),s.jsxs("span",{className:"text-sm text-dark-500",children:[Q.followUpTimeout/1e3,"s"]})]}),s.jsx("input",{type:"range",min:"30000",max:"120000",step:"10000",value:Q.followUpTimeout,onChange:e=>Z(s=>({...s,followUpTimeout:Number(e.target.value)})),className:"w-full accent-indigo-500"}),s.jsx("p",{className:"text-xs text-dark-400 mt-1",children:'Time before asking "anything else?"'})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"End Chat Timeout"}),s.jsxs("span",{className:"text-sm text-dark-500",children:[Q.endChatTimeout/1e3,"s"]})]}),s.jsx("input",{type:"range",min:"15000",max:"60000",step:"5000",value:Q.endChatTimeout,onChange:e=>Z(s=>({...s,endChatTimeout:Number(e.target.value)})),className:"w-full accent-indigo-500"}),s.jsx("p",{className:"text-xs text-dark-400 mt-1",children:"Time after follow-up to auto-end chat"})]}),s.jsxs("button",{onClick:()=>{P(Q),l.success("Settings saved!")},className:"btn-primary w-full flex items-center justify-center gap-2",children:[s.jsx(b,{className:"w-4 h-4"}),"Save Settings"]})]})]}),s.jsxs("div",{className:"card p-6 lg:col-span-2",children:[s.jsxs("div",{className:"flex justify-between items-center mb-6",children:[s.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[s.jsx(f,{className:"w-5 h-5 text-indigo-500"}),"Training Logs"]}),s.jsxs("button",{onClick:()=>{F([]),l.success("Logs cleared")},className:"btn-outline text-sm flex items-center gap-2",children:[s.jsx(y,{className:"w-4 h-4"}),"Clear Logs"]})]}),s.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2",children:0===I.length?s.jsx("p",{className:"text-center text-dark-400 py-8",children:"No logs yet"}):I.map(e=>s.jsxs(v.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:i("flex items-center gap-3 p-3 rounded-lg text-sm","success"===e.type&&"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400","error"===e.type&&"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400","info"===e.type&&"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400"),children:["success"===e.type&&s.jsx(x,{className:"w-4 h-4"}),"error"===e.type&&s.jsx(o,{className:"w-4 h-4"}),"info"===e.type&&s.jsx(f,{className:"w-4 h-4"}),s.jsx("span",{className:"flex-1",children:e.message}),s.jsx("span",{className:"text-xs opacity-60",children:new Date(e.timestamp).toLocaleTimeString()})]},e.id))})]}),s.jsxs("div",{className:"card p-6 lg:col-span-2",children:[s.jsxs("h2",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:[s.jsx(r,{className:"w-5 h-5 text-indigo-500"}),"Agent Profiles Preview"]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4",children:L.slice(0,10).map(e=>s.jsxs("div",{className:"text-center p-4 rounded-xl bg-dark-50 dark:bg-dark-700/50",children:[s.jsx("img",{src:e.avatar,alt:e.name,className:"w-16 h-16 rounded-full mx-auto mb-2 border-2 border-indigo-200 dark:border-indigo-800"}),s.jsx("p",{className:"font-medium text-sm",children:e.name}),s.jsx("p",{className:"text-xs text-dark-400",children:e.nameLocal})]},e.id))})]})]})]})}export{k as default};
